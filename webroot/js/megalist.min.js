!function(n){"use strict";var t=function(n){this.touchSupported=!1;this.thumboverride=-1;this.$el=null;this.init(n)};t.prototype={animating:!1,constructor:t,init:function(t){var i,r;this.vendorPrefix=this.getVendorPrefix();i=this;this.MAX_CLICK_DURATION_MS=350;this.MAX_MOUSE_POSITION_FLOAT_PX=10;this.MAX_TOUCH_POSITION_FLOAT_PX=10;this.SCROLLBAR_BORDER=1;this.SCROLLBAR_MIN_SIZE=38;this.RESIZE_TIMEOUT_DELAY=100;this.processedItems={};this.totalItems=[];this.itemHeight=-1;this.touchSupported="onorientationchange"in window;this.$el=n(t);this.$ul=this.$el.find("ul");this.$scrollbar=n("<div id='scrollbar'><\/div>");this.$ul.length<=0&&(this.$ul=n("<ul />"),this.$el.append(this.$ul));this.$el.append(this.$scrollbar);this.dataProvider=this.$ul.find("li");this.listItems=this.dataProvider.length>0?this.dataProvider:n();this.listItems.each(function(t){t===0&&(i.itemHeight=n(this).outerHeight());n(this).addClass("megalistItem");n(this).remove()});this.$ul.css("visibility","visible");this.editpos=0;this.yPosition=0;this.updateLayout();this.resizeHandler=function(n){return i.onResize(n)};this.touchStartHandler=function(n){return i.onTouchStart(n)};this.touchMoveHandler=function(n){return i.onTouchMove(n)};this.touchEndHandler=function(n){return i.onTouchEnd(n)};this.TOUCH_START=this.touchSupported?"touchstart":"mousedown";this.TOUCH_MOVE=this.touchSupported?"touchmove":"mousemove";this.TOUCH_END=this.touchSupported?"touchend":"mouseup";this.MOUSE_WHEEL=navigator.userAgent.search("Fire")<0?"mousewheel":"DOMMouseScroll";n(window).resize(this.resizeHandler);this.$el.bind("gesturestart",function(n){return n.preventDefault(),!1});this.$el.bind(this.TOUCH_START,this.touchStartHandler);this.$el.bind(this.MOUSE_WHEEL,function(n){n.preventDefault();return i.onMouseWheel(n)});n(window).bind("keydown",function(n){return i.onKeydown(n)});this.touchSupported?this.$scrollbar.fadeTo(0,0):(r=parseInt(this.$scrollbar.css("width"),10),this.$scrollbar.css("width",1.25*r),this.scrollbarStartHandler=function(n){return i.scrollbarTouchStart(n)},this.scrollbarMoveHandler=function(n){return i.scrollbarTouchMove(n)},this.scrollbarEndHandler=function(n){return i.scrollbarTouchEnd(n)},this.$scrollbar.bind(this.TOUCH_START,this.scrollbarStartHandler));this.inputCoordinates=null;this.velocity={distance:0,lastTime:0,timeDelta:0}},getVendorPrefix:function(){var t=/^(Moz|Webkit|Khtml|O|ms|Icab)(?=[A-Z])/,n=document.getElementsByTagName("script")[0];for(var i in n.style)if(t.test(i))return i.match(t)[0];return"WebkitOpacity"in n.style?"Webkit":"KhtmlOpacity"in n.style?"Khtml":""},onResize:function(){var n,t;clearTimeout(this.reizeTimeout);n=this.dataProvider.length*this.itemHeight-this.$el.height();this.yPosition=Math.min(this.yPosition,n);t=this;this.reizeTimeout=setTimeout(function(){t.updateLayout()},this.RESIZE_TIMEOUT_DELAY)},onTouchStart:function(t){return isIE||isIEEdge||navigator.msMaxTouchPoints||t.target.nodeName=="IMG"||this.animating||(this.animating=!0,this.render()),this.touchSupported&&this.$scrollbar.fadeTo(300,1),this.cleanupEventHandlers(),this.$el.unbind(this.TOUCH_START,this.touchStartHandler),n(document).bind(this.TOUCH_MOVE,this.touchMoveHandler),n(document).bind(this.TOUCH_END,this.touchEndHandler),this.updateVelocity(0),this.inputCoordinates=this.getInputCoordinates(t),this.inputStartCoordinates=this.inputCoordinates,this.inputStartTime=(new Date).getTime(),t.preventDefault(),!1},onTouchMove:function(n){var t,i,r,u;if(!megadragging&&n.which!=3)return t=this.getInputCoordinates(n),i=this.inputCoordinates.y-t.y,this.yPosition+=i,this.updateVelocity(i),r=Math.ceil(this.yPosition/this.itemHeight),r<0&&r*this.itemHeight<=-(this.$el.height()-this.itemHeight)&&(this.yPosition=-(this.$el.height()-this.itemHeight)),u=this.dataProvider.length*this.itemHeight-this.itemHeight,this.yPosition>u&&(this.yPosition=u),this.inputCoordinates=t,n.preventDefault(),!1},onTouchEnd:function(n){var i,t;return this.animating=!1,i=this.$el.attr("id"),this.inputEndCoordinates=this.inputCoordinates,t=this.detectClickEvent(n),this.inputCoordinates=null,this.cleanupEventHandlers(),t?this.cleanupListItems():this.scrollWithInertia(),this.$el.bind(this.TOUCH_START,this.touchStartHandler),n.preventDefault(),!1},onKeydown:function(n){var t,i,r;if(this.$el.is(":hover")){t=0;switch(n.which){case 33:t=-1*Math.floor(this.$el.height()/this.itemHeight);break;case 34:t=Math.floor(this.$el.height()/this.itemHeight);break;case 38:t=-1;break;case 40:t=1;break;default:return}return this.yPosition+=t*this.itemHeight,i=this.dataProvider.length*this.itemHeight-this.$el.height(),this.yPosition>i&&(this.yPosition=i),this.yPosition<0&&(this.yPosition=0),r=this,this.updateLayout(),this.cleanupTimeout=setTimeout(function(){r.cleanupListItems()},100),!1}},onMouseWheel:function(n){var t,i,r,u;return clearTimeout(this.cleanupTimeout),t=n.originalEvent,i=0,t.wheelDelta&&(i=t.wheelDelta/120),t.detail&&(i=-t.detail/3),t.wheelDeltaY!==undefined&&(i=t.wheelDeltaY/120),this.yPosition-=i*this.itemHeight,r=this.dataProvider.length*this.itemHeight-this.$el.height(),this.yPosition>r&&(this.yPosition=r),this.yPosition<0&&(this.yPosition=0),u=this,this.updateLayout(),this.cleanupTimeout=setTimeout(function(){u.cleanupListItems()},100),!1},detectClickEvent:function(t){for(var i=t.target,o,r,f,u,e;i.parentNode!=undefined;){if(i.nodeName==="LI")break;i=i.parentNode}return i.nodeName==="LI"&&(o=(new Date).getTime(),o-this.inputStartTime<this.MAX_CLICK_DURATION_MS&&(r={x:Math.abs(this.inputStartCoordinates.x-this.inputEndCoordinates.x),y:Math.abs(this.inputStartCoordinates.y-this.inputEndCoordinates.y)},this.editpos=this.yPosition,f=!1,f=this.touchSupported?r.x<=this.MAX_TOUCH_POSITION_FLOAT_PX&&r.y<=this.MAX_TOUCH_POSITION_FLOAT_PX:r.x<=this.MAX_MOUSE_POSITION_FLOAT_PX&&r.y<=this.MAX_MOUSE_POSITION_FLOAT_PX,f))?(u=n(i).attr("list-index"),this.setSelectedIndex(u),e=this,setTimeout(function(){var r={selectedIndex:u,srcElement:n(i),item:e.dataProvider[u]},f;f=t.which==3?jQuery.Event("rchange",r):jQuery.Event("change",r);e.$el.trigger(f)},150),!0):!1},cleanupEventHandlers:function(){n(document).unbind(this.TOUCH_MOVE,this.touchMoveHandler);n(document).unbind(this.TOUCH_END,this.touchEndHandler);n(document).unbind(this.TOUCH_MOVE,this.scrollbarMoveHandler);n(document).unbind(this.TOUCH_END,this.scrollbarEndHandler)},cleanupListItems:function(n){for(var u,i,t,r=0;r<this.totalItems.length;r++)i=this.totalItems[r],t=i.attr("list-index"),this.processedItems[t]===undefined&&i.remove();if(u=[],this.processedItems)for(t in this.processedItems)u.push(this.processedItems[t]);this.totalItems=u;this.touchSupported&&n!==!0&&this.$scrollbar.fadeTo(300,0)},getInputCoordinates:function(n){var t;return t=this.touchSupported?n.originalEvent.touches[0]:n,{x:Math.round(t.pageX),y:Math.round(t.pageY)}},updateLayout:function(n){var u,i,t;if(this.dataProvider.length>0){u=this.$el.height();this.$ul.detach();var r=-1,f=Math.ceil(this.yPosition/this.itemHeight),e=-(this.yPosition%this.itemHeight);for(this.setItemPosition(this.$ul,0,-this.yPosition),this.processedItems={};r*this.itemHeight<2*(u+2*this.itemHeight);){if(i=Math.max(f+r,0),i=Math.min(i,this.dataProvider.length),t=this.getItemAtIndex(i),this.totalItems.push(t),this.processedItems[i.toString()]=t,this.setItemPosition(t,0,(f+r)*this.itemHeight),t.parent().length<=0&&(this.$ul.append(t),this.itemHeight<=0)){this.$el.append(this.$ul);this.itemHeight=t.outerHeight();this.updateLayout();return}r++}this.cleanupListItems(!0);n!==!0&&this.updateScrollBar();this.$scrollbar.before(this.$ul)}},updateScrollBar:function(){var i=this.$el.height(),r=this.$el.height()-2*this.SCROLLBAR_BORDER,f=this.dataProvider.length*this.itemHeight,e=Math.min(r/f,1)*r,n=Math.max(e,this.SCROLLBAR_MIN_SIZE),t=this.SCROLLBAR_BORDER+this.yPosition/(f-i)*(r-n),u;t<this.SCROLLBAR_BORDER?(n=Math.max(n+t,0),t=this.SCROLLBAR_BORDER):t>i-n&&(n=Math.min(n,i-(t+this.SCROLLBAR_BORDER)));this.$scrollbar.height(n);u=this.$scrollbar.parent();this.dataProvider.length*this.itemHeight<=this.$el.height()?u.length>0&&this.$scrollbar.remove():(u.length<=0&&this.$el.append(this.$scrollbar),this.$scrollbar.css("top",t))},updateVelocity:function(n){this.velocity.distance=n;var t=(new Date).getTime();this.velocity.timeDelta=t-this.velocity.lastTime;this.velocity.lastTime=t;this.velocity.timeDelta>1e3&&(this.velocity.distance=0)},render:function(){var n=this;this.animating&&requestAnimFrame(function(){n.render()});this.updateLayout()},scrollWithInertia:function(){var r=Math.ceil(this.yPosition/this.itemHeight),t,n,i;if(r<=0&&this.yPosition<=0||this.dataProvider.length*this.itemHeight<this.$el.height()){this.snapToTop();return}if(t=this.dataProvider.length*this.itemHeight-this.$el.height(),this.yPosition>t){this.snapToBottom();return}n=this.velocity.distance*.97*(Math.max(1e3-this.velocity.timeDelta,0)/1e3);this.yPosition+=n;this.updateVelocity(n);this.updateLayout();i=this;Math.abs(n)>=1?(this.cleanupListItems(!0),requestAnimFrame(function(){i.scrollWithInertia()})):this.cleanupListItems()},snapToTop:function(){var n=this;this.yPosition<-2?(this.yPosition+=(0-this.yPosition)/5,this.updateLayout(),this.animating||requestAnimFrame(function(){n.snapToTop()})):(this.yPosition=0,this.updateLayout(),this.cleanupListItems())},snapToBottom:function(){var t=this,n=this.dataProvider.length*this.itemHeight-this.$el.height();Math.round(this.yPosition)>n?(this.yPosition+=(n-this.yPosition)/5,this.updateLayout(),this.animating||requestAnimFrame(function(){t.snapToBottom()})):(this.yPosition=n,this.updateLayout(),this.cleanupListItems())},setItemPosition:function(n,t,i){var u,r,f;(this.useTransform===null||this.useTransform===undefined)&&(u=document.body||document.documentElement,r=u.style,this.useTransform=r.WebkitTransition!==undefined||r.MozTransition!==undefined||r.OTransition!==undefined||r.transition!==undefined);n.css("left",t);n.css("top",i);this.setCellHeight(this.thumboverride)},getItemAtIndex:function(t){var i,r,u,f;return this.dataProvider===this.listItems?i=n(this.listItems[t]):t!==undefined&&(r=t.toString(),this.listItems[r]===null||this.listItems[r]===undefined?(i=n("<li class='megalistItem' />"),this.listItems[r]=i):i=this.listItems[t],t>=0&&t<this.dataProvider.length&&(u=this.dataProvider[t],f=this.labelFunction?this.labelFunction(u):u.toString(),i.html(f))),i!==null&&i!==undefined&&i.attr("list-index",t),i},setDataProvider:function(t){this.clearSelectedIndex();this.dataProvider=t;this.$ul.find("li").each(function(){n(this).remove()});this.yPosition=0;this.updateLayout()},setCellHeight:function(t){(this.thumboverride=t,t<0)||(this.itemHeight!=-1&&(this.itemHeight=t),this.$ul.find("li").each(function(){t>47?n(this).addClass("ml-thumb"):n(this).removeClass("ml-thumb")}))},setLabelFunction:function(n){this.labelFunction=n;this.updateLayout()},getSelectedIndex:function(){return mega_SelectedIndex=parseInt(this.selectedIndex,10),parseInt(this.selectedIndex,10)},setSelectedIndex:function(n){var t=this.getItemAtIndex(this.selectedIndex);t!==undefined&&t.removeClass("megalistSelected");this.selectedIndex=n;this.getItemAtIndex(n).addClass("megalistSelected")},setSelectedIndexMove:function(n){var i=this.getItemAtIndex(this.selectedIndex),r,u,t,f;i!==undefined&&i.removeClass("megalistSelected");this.selectedIndex=n;this.getItemAtIndex(n).addClass("megalistSelected");r=this.yPosition/this.itemHeight;u=n-r;this.yPosition+=u*this.itemHeight;t=this.dataProvider.length*this.itemHeight-this.$el.height();this.yPosition>t&&(this.yPosition=t);this.yPosition<0&&(this.yPosition=0);f=this;this.updateLayout();this.cleanupTimeout=setTimeout(function(){f.cleanupListItems()},100)},setSelectedIndexEditR:function(n){var i=this.getItemAtIndex(this.selectedIndex),t,r;i!==undefined&&i.removeClass("megalistSelected");this.selectedIndex=n;this.getItemAtIndex(n).addClass("megalistSelected");this.yPosition=this.editpos;t=this.dataProvider.length*this.itemHeight-this.$el.height();this.yPosition>t&&(this.yPosition=t);this.yPosition<0&&(this.yPosition=0);r=this;this.updateLayout();this.cleanupTimeout=setTimeout(function(){r.cleanupListItems()},100)},clearSelectedIndex:function(){var n=this.getItemAtIndex(this.selectedIndex);n!==undefined&&n.removeClass("megalistSelected");this.selectedIndex=-1},scrollbarTouchStart:function(t){return this.cleanupEventHandlers(),this.scrollbarInputCoordinates=this.getInputCoordinates(t),n(document).bind(this.TOUCH_MOVE,this.scrollbarMoveHandler),n(document).bind(this.TOUCH_END,this.scrollbarEndHandler),t.preventDefault(),!1},scrollbarTouchMove:function(n){var r=this.getInputCoordinates(n),u=this.scrollbarInputCoordinates.y-r.y,t=parseInt(this.$scrollbar.css("top"),10),i;return t-=u,t=Math.max(t,this.SCROLLBAR_BORDER),t=Math.min(t,this.$el.height()-this.SCROLLBAR_BORDER-this.$scrollbar.height()),this.$scrollbar.css("top",t),this.scrollbarInputCoordinates=r,i=(t-this.SCROLLBAR_BORDER)/(this.$el.height()-2*this.SCROLLBAR_BORDER-this.$scrollbar.height())*(this.itemHeight*this.dataProvider.length-1),i=Math.max(0,i),i=Math.min(i,this.itemHeight*this.dataProvider.length-(this.$el.height()-2*this.SCROLLBAR_BORDER-this.$scrollbar.height())),this.yPosition=i,this.updateLayout(!0),n.preventDefault(),!1},scrollbarTouchEnd:function(n){return this.cleanupEventHandlers(),this.cleanupListItems(),n.preventDefault(),!1}};n.fn.megalist=function(i,r){return this.each(function(){var f=n(this),u=f.data("list");u||f.data("list",u=new t(this));typeof i=="string"&&u[i](r)})};n.fn.megalist.Constructor=t}(window.jQuery)